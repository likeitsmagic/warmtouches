<!doctype html>
<html lang="en">
<head>
    <title>Feel it</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="css/default.css">
</head>
<body>
    <script>
        // Function to get URL parameters
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Get the 'startapp' parameter
        const startAppParam = getUrlParameter('startapp');
        console.log(`Start App Parameter: ${startAppParam}`);

        // Use this parameter as needed in your app
        document.addEventListener("DOMContentLoaded", function() {
            if (startAppParam && startAppParam !== 'null') {
                document.getElementById("userGreeting").innerText = `Welcome! Your ID is: ${startAppParam}`;
            } else {
                document.getElementById("userGreeting").innerText = "Welcome! No valid ID provided.";
            }
        });

        // Function to generate room link with user ID
        function generateRoomLink() {
            const userId = startAppParam && startAppParam !== 'null' ? startAppParam : "defaultUser"; // Fallback if null
            return `https://t.me/WarmTouchesBot?startapp=${encodeURIComponent(userId)}`; // Constructing the link
        }
    </script>

    <section id="home">
        <div class="container">
            <div class="row vh-md-100">
                <div class="col-md-8 col-sm-10 col-12 mx-auto my-auto text-center">
                    <h1 id="userGreeting" class="heading-black text-capitalize" style="margin-top: 60px;">Feel it</h1>
                    <img src="./img/touch.jpg" alt="" style="width: 200px">
                    <p class="lead py-3">Feel the touch of a loved one from a distance</p>
                    <a href="room.html">
                        <button class="btn btn-primary d-inline-flex flex-row align-items-center">Shall we?</button>
                    </a>
                    
                    <!-- Updated Add Partner Button -->
                    <a href="#" onClick='window.open("https://telegram.me/share/url?url=" + encodeURIComponent(generateRoomLink()), "sharer", "status=0,toolbar=0,width=650,height=500");' class="btn btn-default smoothScroll wow fadeInUp">
                        <button class="btn btn-primary d-inline-flex flex-row align-items-center">Add a partner</button>
                    </a>
                </div>
            </div>
        </div>
    </section>

</body>
</html>
